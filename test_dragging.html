<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è - –ú–∞—Å—Ç–µ—Ä –í–æ–¥—è–Ω—ã—Ö –ó–Ω–∞–∫–æ–≤</title>
    <script src="https://unpkg.com/draggabilly@3/dist/draggabilly.pkgd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-container { 
            width: 400px; 
            height: 300px; 
            border: 2px solid #ccc; 
            position: relative; 
            background: #f0f4f8;
            margin: 20px auto;
        }
        .draggable { 
            position: absolute; 
            background: rgba(59, 130, 246, 0.8); 
            color: white; 
            padding: 10px; 
            cursor: move; 
            border-radius: 5px;
            user-select: none;
        }
        .guide-line {
            position: absolute;
            background-color: rgba(255, 0, 0, 0.5);
            display: none;
            z-index: 9;
        }
        #guide-y {
            width: 1px;
            height: 100%;
            left: 50%;
            top: 0;
        }
        #guide-x {
            width: 100%;
            height: 1px;
            top: 50%;
            left: 0;
        }
        .info { 
            background: #f8f9fa; 
            padding: 15px; 
            border-radius: 5px; 
            margin: 20px 0; 
        }
        .coordinates { 
            background: #e9ecef; 
            padding: 10px; 
            border-radius: 3px; 
            font-family: monospace; 
            margin: 10px 0; 
        }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –≤–æ–¥—è–Ω—ã—Ö –∑–Ω–∞–∫–æ–≤</h1>
    
    <div class="info">
        <h3>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h3>
        <ul>
            <li>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å–∏–Ω–∏–π –±–ª–æ–∫ –≤ –ª—é–±–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏</li>
            <li>–ü—Ä–∏ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –∫ —Ü–µ–Ω—Ç—Ä—É –ø–æ—è–≤–∏—Ç—Å—è –∫—Ä–∞—Å–Ω–∞—è –Ω–∞–ø—Ä–∞–≤–ª—è—é—â–∞—è –ª–∏–Ω–∏—è</li>
            <li>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
            <li>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (0-1)</li>
        </ul>
    </div>

    <div class="test-container">
        <div id="guide-y" class="guide-line"></div>
        <div id="guide-x" class="guide-line"></div>
        <div id="draggable" class="draggable">
            –í–æ–¥—è–Ω–æ–π –∑–Ω–∞–∫
        </div>
    </div>

    <div class="coordinates">
        <strong>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</strong><br>
        X: <span id="coord-x">0.5</span><br>
        Y: <span id="coord-y">0.5</span><br>
        –ü–æ–∑–∏—Ü–∏—è: <span id="position">–¶–µ–Ω—Ç—Ä</span>
    </div>

    <div class="info">
        <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞:</h3>
        <div id="test-result">–û–∂–∏–¥–∞–Ω–∏–µ...</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const container = document.querySelector('.test-container');
            const draggable = document.getElementById('draggable');
            const guideY = document.getElementById('guide-y');
            const guideX = document.getElementById('guide-x');
            const coordX = document.getElementById('coord-x');
            const coordY = document.getElementById('coord-y');
            const position = document.getElementById('position');
            const testResult = document.getElementById('test-result');

            let draggie = new Draggabilly(draggable, {
                containment: container
            });

            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –ø–æ —Ü–µ–Ω—Ç—Ä—É
            const containerRect = container.getBoundingClientRect();
            const draggableRect = draggable.getBoundingClientRect();
            const centerX = (containerRect.width - draggableRect.width) / 2;
            const centerY = (containerRect.height - draggableRect.height) / 2;
            
            draggie.setPosition(centerX, centerY);
            updateCoordinates();

            function updateCoordinates() {
                const containerRect = container.getBoundingClientRect();
                const draggableRect = draggable.getBoundingClientRect();
                const x = draggie.position.x;
                const y = draggie.position.y;
                
                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–∞ –≤–æ–¥—è–Ω–æ–≥–æ –∑–Ω–∞–∫–∞
                const centerX = x + (draggableRect.width / 2);
                const centerY = y + (draggableRect.height / 2);
                
                const relativeX = centerX / containerRect.width;
                const relativeY = centerY / containerRect.height;
                
                coordX.textContent = relativeX.toFixed(4);
                coordY.textContent = relativeY.toFixed(4);
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
                let posText = '';
                if (relativeX < 0.2) posText += '–õ–µ–≤–æ ';
                else if (relativeX > 0.8) posText += '–ü—Ä–∞–≤–æ ';
                else if (Math.abs(relativeX - 0.5) < 0.1) posText += '–¶–µ–Ω—Ç—Ä ';
                
                if (relativeY < 0.2) posText += '–í–µ—Ä—Ö';
                else if (relativeY > 0.8) posText += '–ù–∏–∑';
                else if (Math.abs(relativeY - 0.5) < 0.1) posText += '–¶–µ–Ω—Ç—Ä';
                
                position.textContent = posText || '–°–≤–æ–±–æ–¥–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è';
            }

            function handleDragMove() {
                const containerRect = container.getBoundingClientRect();
                const draggableRect = draggable.getBoundingClientRect();
                const draggieX = draggie.position.x;
                const draggieY = draggie.position.y;

                const watermarkCenterX = draggieX + (draggableRect.width / 2);
                const watermarkCenterY = draggieY + (draggableRect.height / 2);
                const containerCenterX = containerRect.width / 2;
                const containerCenterY = containerRect.height / 2;

                const snapThreshold = 10;

                const isNearHorizontalCenter = Math.abs(watermarkCenterX - containerCenterX) < snapThreshold;
                const isNearVerticalCenter = Math.abs(watermarkCenterY - containerCenterY) < snapThreshold;

                if (isNearHorizontalCenter) {
                    guideY.style.display = 'block';
                } else {
                    guideY.style.display = 'none';
                }

                if (isNearVerticalCenter) {
                    guideX.style.display = 'block';
                } else {
                    guideX.style.display = 'none';
                }
            }

            draggie.on('dragMove', () => {
                handleDragMove();
                updateCoordinates();
            });

            draggie.on('dragEnd', () => {
                guideX.style.display = 'none';
                guideY.style.display = 'none';
                updateCoordinates();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
                const x = parseFloat(coordX.textContent);
                const y = parseFloat(coordY.textContent);
                
                if (x >= 0 && x <= 1 && y >= 0 && y <= 1) {
                    testResult.innerHTML = '<span style="color: green;">‚úÖ –¢–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω! –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã.</span>';
                } else {
                    testResult.innerHTML = '<span style="color: red;">‚ùå –û—à–∏–±–∫–∞! –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –≤–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ 0-1.</span>';
                }
            });

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
            setTimeout(() => {
                console.log('–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π...');
                
                // –¢–µ—Å—Ç 1: –í–µ—Ä—Ö–Ω–∏–π –ª–µ–≤—ã–π —É–≥–æ–ª
                draggie.setPosition(0, 0);
                setTimeout(() => {
                    const x = parseFloat(coordX.textContent);
                    const y = parseFloat(coordY.textContent);
                    console.log('–í–µ—Ä—Ö–Ω–∏–π –ª–µ–≤—ã–π —É–≥–æ–ª:', x, y);
                    
                    // –¢–µ—Å—Ç 2: –¶–µ–Ω—Ç—Ä
                    draggie.setPosition(centerX, centerY);
                    setTimeout(() => {
                        const x = parseFloat(coordX.textContent);
                        const y = parseFloat(coordY.textContent);
                        console.log('–¶–µ–Ω—Ç—Ä:', x, y);
                        
                        // –¢–µ—Å—Ç 3: –ù–∏–∂–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª
                        const maxX = containerRect.width - draggableRect.width;
                        const maxY = containerRect.height - draggableRect.height;
                        draggie.setPosition(maxX, maxY);
                        setTimeout(() => {
                            const x = parseFloat(coordX.textContent);
                            const y = parseFloat(coordY.textContent);
                            console.log('–ù–∏–∂–Ω–∏–π –ø—Ä–∞–≤—ã–π —É–≥–æ–ª:', x, y);
                            
                            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ —Ü–µ–Ω—Ç—Ä
                            draggie.setPosition(centerX, centerY);
                        }, 1000);
                    }, 1000);
                }, 1000);
            }, 2000);
        });
    </script>
</body>
</html>