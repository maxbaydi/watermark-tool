# Масштабирование водяных знаков в процентах

## Проблема
При пакетной обработке изображений разных размеров водяные знаки выглядели по-разному, так как их размер рассчитывался в абсолютных пикселях.

## Решение
Переход на процентное масштабирование относительно ширины изображения.

## Изменения

### 1. Интерфейс (index.html)

#### Размер шрифта:
- **Было**: 10-200 пикселей
- **Стало**: 0.5-10% от ширины изображения
- **По умолчанию**: 2% от ширины

#### Размер водяного знака-изображения:
- **Было**: 0.05-1.0 (доля от ширины)
- **Стало**: 5-100% от ширины изображения
- **По умолчанию**: 25% от ширины

### 2. JavaScript логика

#### Расчет размера в превью:
```javascript
// Для текста
const fontSizePercent = parseFloat(fontSize.value);
const previewFontSize = (fontSizePercent / 100 * baseImagePreview.width);

// Для изображения
const watermarkSizePercent = parseFloat(watermarkSize.value);
const previewWatermarkWidth = (watermarkSizePercent / 100 * baseImagePreview.width);
```

#### Передача параметров:
- `fontSizePercent` - размер шрифта в процентах
- `watermarkSizePercent` - размер водяного знака в процентах

### 3. PHP обработка (process.php)

#### Текстовый водяной знак:
```php
// Размер шрифта в процентах от ширины изображения
$fontSizePercent = floatval($settings['fontSizePercent'] ?? 0);
$fontSize = intval(($fontSizePercent / 100) * $image->getImageWidth());
```

#### Водяной знак-изображение:
```php
// Размер водяного знака в процентах от ширины изображения
$watermarkSizePercent = floatval($settings['watermarkSizePercent'] ?? 0);
$new_width = ($watermarkSizePercent / 100) * $image->getImageWidth();
```

## Преимущества

1. **Консистентность**: Водяной знак выглядит одинаково на всех изображениях
2. **Масштабируемость**: Автоматически адаптируется к любому размеру изображения
3. **Интуитивность**: Пользователь видит размер в процентах от изображения
4. **Точность**: Позиционирование остается точным независимо от размера

## Примеры

### Изображение 1920x1080:
- Шрифт 2% = 38.4px
- Водяной знак 25% = 480px

### Изображение 800x600:
- Шрифт 2% = 16px  
- Водяной знак 25% = 200px

### Изображение 4000x3000:
- Шрифт 2% = 80px
- Водяной знак 25% = 1000px

## Fallback
Если процентные значения не переданы, система использует старую логику для обратной совместимости.

## Тестирование
Рекомендуется протестировать с изображениями разных размеров:
- Маленькие (400x300)
- Средние (1920x1080) 
- Большие (4000x3000)
- Квадратные (1000x1000)
- Портретные (1080x1920) 